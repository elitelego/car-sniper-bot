# Car Sniper Bot (MVP)

Telegram-бот для мгновенных уведомлений о новых объявлениях с auto24.ee (MVP).  
**Важно:** уважайте правила сайта и robots.txt. Этот MVP предназначен только для личного теста, без агрессивной нагрузки.

## Возможности
- Команда `/filter` для установки фильтров:  
  `price=2000-6000 year=2006-2020 km<=250000 brand=toyota,bmw,mercedes,skoda,vw,audi`
- Каждые 60 секунд бот проверяет новые карточки на первой странице и шлёт подходящие.
- Хранит «уже увиденные» ID, чтобы не спамить повторами.

## Переменные окружения
- `BOT_TOKEN` — токен вашего Telegram-бота (НЕ храните его в коде).
- `DB_PATH` — путь к SQLite (по умолчанию `data.db`).
- `SCAN_INTERVAL` — период сканирования в секундах (по умолчанию 60).
- `DEFAULT_FILTERS_JSON` — JSON со стартовыми фильтрами (опционально).

Пример `.env` (не коммитьте его в гит):
```
BOT_TOKEN=123456:ABC-DEF...
DB_PATH=data.db
SCAN_INTERVAL=60
DEFAULT_FILTERS_JSON={"price_min":2000,"price_max":6000,"year_min":2006,"year_max":2020,"km_max":250000,"brands":["toyota","bmw","mercedes-benz","skoda","vw","audi"]}
```

## Локальный запуск
1. Установите Python 3.11+
2. Создайте и активируйте venv
3. `pip install -r requirements.txt`
4. Экспортируйте переменные окружения (или используйте `.env` менеджер)
5. `python app.py`

## Развёртывание на Render (worker)
1. Создайте новый Blueprint репозиторий или загрузите файлы.
2. Создайте сервис типа **Background Worker**.
3. Установите переменные окружения: `BOT_TOKEN`, `SCAN_INTERVAL=60`, `DB_PATH=/data/data.db`.
4. Команда запуска: `python app.py`
5. Включите persistent disk (например, `/data`).

## Развёртывание на Railway / Fly.io / Heroku
- Railway: создайте **Service**, задайте переменные окружения, команда запуска `python app.py`.
- Heroku (Stack 22): создайте приложение, добавьте buildpack `heroku/python`, 
  переменные окружения, Procfile:
  ```
  worker: python app.py
  ```

## Замечания
- Маркап сайтов меняется — парсер максимально аккуратный, но простой. В случае изменений придётся подправить селекторы.
- Для реального продакшена рекомендуются: очередь задач, кеш, троттлинг запросов, а также отдельные адаптеры для разных сайтов.
- Обязательно **перевыпустите токен** у BotFather, если когда-либо светили его публично ( `/revoke` → `/token` ).
